---
title: ActiveReportsJS
description: 
published: true
date: 2023-05-12T01:52:36.091Z
tags: 
editor: markdown
dateCreated: 2023-01-12T06:37:08.281Z
---

# ActiveReportsJS
- [ ] [ActiveReportsJS](https://www.grapecity.com/activereportsjs)
- [ ] [ActiveReportsJS cn](https://demo.grapecity.com.cn/activereportsjs/docs/GettingStarted/ResourceGuid)
- [ ] [JavaScript Report Designer | ActiveReportsJS](https://www.youtube.com/watch?v=xPIp77h8Vqw&loop=0)
- [ ] [純前端線上報表控制項](https://www.grapecity.com.cn/developer/activereportsjs)
- [ ] [ActiveReportsJS入門教學：如何在PureJS 框架中使用 ActiveReportsJS建立 Web應用](https://www.evget.com/article/2020/2/27/34875.html)
- [ ] [Get Started with Integrating ActiveReportsJS Reporting Tools into Your ReactJS Application](https://www.youtube.com/watch?v=7z3ErjElLYY&loop=0)
- [ ] [How to Choose Between ActiveReports.NET and ActiveReportsJS](https://www.grapecity.com/blogs/how-to-choose-between-activereportsdotnet-and-activereportsjs)
- [ ] [Getting Started with ActiveReportsJS](https://www.grapecity.com/blogs/getting-started-with-activereportsjs)
- [ ] [ConvertHTMLToWord](https://jscodemine.grapecity.com/share/Itym7G5fAUSWY4ffuu2cJw/)
- [ ] [Fonts Configuration](https://www.grapecity.com/activereportsjs/docs/GettingStarted/FontConfiguration)

# 簡介
> - ActiveReportsJS 是一款基於 HTML5 的純前端線上報表控制項，通過拖曳式跨平台報表設計器和純前端報表設計器，可以快速地設計 Excel 報表、 Word 文件、 移動端報表、圖表、資料過濾、資料鑽取、精準套打等類型報表，可全面滿足 JavaScript、HTML5、Angular、Vue、React、PureJS ，Nodejs 等項目開發的報表設計、展示、列印匯出等需求。同時，通過豐富的 API 可以靈活的實現報表建立、載入和執行階段的個性化自訂需求。
> - 純前端報表設計器是 ActiveReportsJS 提供的報表設計元件，可直接在 Angular、 React、 Vue 等前端框架中呼叫，內建開放的 API 可供開發人員使用，實現定製化的線上報表編輯器，為終端使用者帶來易用性和功能性都很強大的編輯器能力。

ActiveReportsJS 是一種 Report 解決方案，是一個基於 Web 的 JavaScript 應用程式，集行數據可視化。

包括具有豐富元件的獨立多平台設計應用程式。

1. 與報表介面元件一起使用，支援 React、Angular 和 Vue

2. 使用報告介面自定義和顯示報告輸出

3. 通過靈活的許可模式選擇適合您需求的選項



# ActiveReportsJS 可以為報表開發者提供什麼？
## 簡單易用的 Web 報表設計器
集編輯、預覽、匯出為一體的 跨平台（純前端）報表設計器，類 Office 設計體驗，內建 矩表， 表格， 圖表， 條碼等十余種控制項滿足各類報表佈局，讓終端使用者亦可自助設計中國式複雜報表

## 純前端精準列印
ActiveReportsJS 通過其獨有的分層設計，實現了精準前端 報表套打。即可以一次生成報表範本，批次列印，也可以採用分頁設計模式，實現連續列印

## 一鍵匯出報表
ActiveReportsJS 支援以“所見即所得”的方式，匯出 PDF、Excel（XLSX）、HTML ，並可通過程式碼，在不預覽報表的情況下直接匯出報表並控制匯出行為，一鍵匯出，快捷高效

## 一流的框架支援及擴展與主流前端開發框架完美相容
ActiveReportsJS 遵循 TypeScript 規範，可與當下主流前端開發框架，如 Angular、 React、 Vue 等完美整合。符合 UMD 規範，可按需載入，易於在 VSCode 中使用

## 高級 JSON 資料繫結功能攻克開發難點
支援繫結 REST API、 OData、或 GraphQL 資料來源，可組態 JSON 獲取方式為 Post 或 Get，也可指定查詢參數等資料連結資訊，一鍵解析多層 JSON 資料巢狀

## 豐富的 API 滿足個性化整合需要
ActiveReportsJS 為線上設計器及 Viewer 提供了靈活且豐富的 API，可幫您建構風格一致的報表功能模組且與您的系統無縫對接，滿足深度定製、無縫整合的需要

## 僅需 3 步，即可在前端框架中嵌入報表功能
![僅需 3 步，即可在前端框架中嵌入報表功能.png](http://192.168.25.60:8000/files/file_storage/d1abc2b5.png)

### 極易使用的純前端報表設計器
ActiveReportsJS 提供了極易使用的純前端線上報表設計器，且易於整合到各種前端應用中，可設計各種複雜的報表類型：
- 純前端線上報表設計，無需安裝即可實現線上編輯能力
- 採用拖曳的設計方式，快速建立資料透視表、複雜報表，Word 報告報表
- 與前端主流框架，如 Angular、 React、 Vue 一鍵整合使用

### 在 Web 頁面，快速嵌入報表模組
只需簡單的幾行程式碼，即可將報表設計器及報表展示功能 嵌入到 Web 頁面中：
- 使用 Viewer 元件為應用程式的終端使用者提供查看，匯出和列印功能
- 使用 Web 報表設計器元件可以使使用者實現編輯報表
- 呼叫整合 API 定製報表 Viewer 或設計器功能

### 無需編碼實現互動功能
為設計器和報表展示工具提供了內建的功能按鈕，只需設定屬性即可實現高級互動功能
- 內建報表翻頁，刷新，尋找及瀏覽模式設定等功能按鈕
- 提供下拉框，日曆，多選框等為使用者提供輸入能力實現資料過濾
- 只需單屬性設定實現 報表鑽取及匯出等功能

# ActiveReportsJS 的功能特色
## 強大的報表設計能力
ActiveReportsJS 具備設計中國式複雜報表，以及互動式報表的能力，借助其強大的報表設計器和豐富的報表元件，可幫助使用者輕鬆設計各種報表類型。

## 多種資料可視化方式
ActiveReportsJS 內建豐富的圖表、迷你圖、圖示集樣式，用以呈現並分析企業資訊化系統中常見的資料可視化場景，幫助使用者以直觀、簡潔的方式理解業務資料。

## 易用的表示式編輯器
內建 10 余種常數欄位，如頁碼、總頁數、使用者資訊等，可直接拖曳生成；提供超百種公式函數，如日期函數、數學函數、流程判斷等。即使不懂技術，也可快速使用。

## 一次設計，隨處運行
使用 ActiveReportsJS，使用者只需完成一次報表設計，即可在跨平台、跨裝置、跨作業系統中再次編輯和展示報表範本，無需重複的報表設計工作，大幅提升報表利用率。

## 一流的框架整合及擴展
ActiveReportsJS 遵循 TypeScript 規範，可與當下最流行的前端開發框架，如 Angular、React、Vue 等完美整合。

## 完美繼承了 ActiveReports
繼承了 ActiveReports 的報表設計功能，並與之相容。從 .NET 遷移到 Web ，無需重新設計報表，減少二次投入成本。

# 安裝
## 下載 [ActiveReportsJS_3.2_Win](https://www.grapecity.com/activereportsjs/download)

## 安裝 Client 端 桌面端報表設計器應用程式
安裝 ActiveReportsJS-Designer.exe

## 設定中文字體 
到此路徑 `C:\Users\11542\AppData\Roaming\ActiveReportsJS Designer`

### 新增放置字體檔的資料夾 `Fonts`，並放置中文字體檔
- 新增一個資料夾 `Fonts`，將中文字體檔 `標楷體.ttf` 放入

![activereportsjs client designer add fonts folder.png](http://192.168.25.60:8000/files/file_storage/5fa370a0.png)

### 修改字體設定檔 `fontsConfig.json`
- 將中文字體設定檔寫入，格式如下

```json
{
	"path": "",
	"descriptors": [
		{
			"name": "標楷體",
			"weight": "100",
			"style": "normal",
			"source": "Fonts/標楷體.ttf"
		},		
	]
}
```

![activereportsjs client designer alter fontsConfig.png](http://192.168.25.60:8000/files/file_storage/064dde55.png)

![activereportsjs client designer alter fontsConfig for adding font setting.png](http://192.168.25.60:8000/files/file_storage/27e77647.png)

### 可以在 Designer 中設定中文字體

![activereportsjs client designer use feature text font for new font.png](http://192.168.25.60:8000/files/file_storage/94d5e0bc.png)

# 安裝 dependency
```shell
npm i @grapecity/activereports
```

# RESTFUL API JWT 驗證功能
## 新增 DATA SOURCES (資料來源)
- DATA 圖示 ➔ 選取 `+` Add ➔ DATA RPOVIDER 選取 Remote JSON ➔ ENDPOINT 輸入 API url ➔ Save Changes
- ENDPOINT：`http://eservice.hokia.com.tw:8115` (此為資訊看板系統 API url)

![activereportsjs restful api jwt authentication add data sources.png](http://192.168.25.60:8000/files/file_storage/5df1cf25.png)

## 新增 DATA SETS (資料集)
- 從 DATA SOURCES 選取 `+` ➔ QUERY 輸入 Uri/path ➔ Method 選取 HTTP GET ➔ Headers 新增 Authorization 及其 Value ➔ Validate ➔ 產生 Database Fields ➔ Save Changes 
- Uri/path：`/api/admin/user/findAll` (此為資訊看板系統取得多筆人員 API )
- Authorization：`Bearer eyJhbGciOiJIUzI1NiIsInR5cC...` (格式為 `Bearer+空格+token`)

![activereportsjs restful api jwt authentication add data set add headers with authorization.png](http://192.168.25.60:8000/files/file_storage/33ec9ffc.png)

- jwt 若驗證失敗會呈顯 `Incorrect query string`，可點選 `Expand` 查看 API res

![activereportsjs restful api jwt authentication incorrect query string expand.png](http://192.168.25.60:8000/files/file_storage/eba443fa.png)

![activereportsjs restful api jwt authentication incorrect query string collapse.png](http://192.168.25.60:8000/files/file_storage/856dce3a.png)

# 實作 Embedded Report Viewer
## 新增一個 json 檔：report.rdlx-json
```json
{
  "Name": "Report",
  "Body": {
    "ReportItems": [
      {
        "Type": "textbox",
        "Name": "TextBox1",
        "Value": "Hello, ActiveReportsJS Viewer",
        "Style": {
          "FontSize": "18pt"
        },
        "Width": "8.5in",
        "Height": "0.5in"
      }
    ]
  }
}
```
## 新增一個 html 檔：indexViewer.html
```html
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />

    <title>ARJS Report Viewer</title>
    <meta name="description" content="ARJS Report viewer" />
    <meta name="author" content="GrapeCity" />
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.0.0/styles/ar-js-ui.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.0.0/styles/ar-js-viewer.css"
      type="text/css"
    />
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-core.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-viewer.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-pdf.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-xlsx.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-html.js"></script>
    <style>
      #viewer-host {
        margin: 0 auto;
        width: 100%;
        height: 100vh;
      }
    </style>
  </head>

  <body>
    <div id="viewer-host">
      <script>
        var viewer = new ActiveReports.Viewer('#viewer-host');
        viewer.open('report.rdlx-json');
      </script>
    </div>
  </body>
</html>
```
## Go live

![activereportsjs embedded viewer.png](http://192.168.25.60:8000/files/file_storage/8ad3665e.png)

# 實作 Embedded Report Designer
## 新增一個 json 檔：report.rdlx-json
```json
{
  "Name": "Report",
  "Body": {
    "ReportItems": [
      {
        "Type": "textbox",
        "Name": "TextBox1",
        "Value": "Hello, ActiveReportsJS Viewer",
        "Style": {
          "FontSize": "18pt"
        },
        "Width": "8.5in",
        "Height": "0.5in"
      }
    ]
  }
}
```
## 新增一個 html 檔：indexDesigner.html
```html
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />

    <title>ARJS Report designer</title>
    <meta name="description" content="ARJS Report designer" />
    <meta name="author" content="GrapeCity" />
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.latest/styles/ar-js-ui.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.latest/styles/ar-js-designer.css"
      type="text/css"
    />
    <script src="https://cdn.grapecity.com/activereportsjs/3.latest/dist/ar-js-core.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.latest/dist/ar-js-designer.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.0.0/styles/ar-js-ui.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.0.0/styles/ar-js-viewer.css"
      type="text/css"
    />
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-core.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-viewer.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-pdf.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-xlsx.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-html.js"></script>
    <style>
      #viewer-host {
        margin: 0 auto;
        width: 100%;
        height: 100vh;
      }
    </style>
    <style>
      #designer-host {
        width: 100%;
        height: 100vh;
      }
    </style>
  </head>

  <body>
    <div id="designer-host">
      <script>
        var designer = new GC.ActiveReports.ReportDesigner.Designer(
          '#designer-host'
        );
        designer.setReport({
          id: 'report.rdlx-json',
          displayName: 'my report',
        });
      </script>
    </div>
  </body>
</html>
```
## Go live

![activereportsjs embedded designer.png](http://192.168.25.60:8000/files/file_storage/7a8c75e7.png)

# 實作 Embedded Report Designer And Viewer
## 將設計好的 report json 放入專案的根目錄
- 在此以 `certificate.rdlx-json` 為例
- 此 json 為使用 Report Designer 設計出的檔案

## 新增一個 html 檔：indexDesignerViewer.html
```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>ARJS Report Designer and Viewer</title>
    <meta name="description" content="ARJS Report designer" />
    <meta name="author" content="GrapeCity" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.latest/styles/ar-js-ui.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.latest/styles/ar-js-designer.css"
      type="text/css"
    />
    <script src="https://cdn.grapecity.com/activereportsjs/3.latest/dist/ar-js-core.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.latest/dist/ar-js-designer.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.0.0/styles/ar-js-ui.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.grapecity.com/activereportsjs/3.0.0/styles/ar-js-viewer.css"
      type="text/css"
    />
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-core.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-viewer.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-pdf.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-xlsx.js"></script>
    <script src="https://cdn.grapecity.com/activereportsjs/3.0.0/dist/ar-js-html.js"></script>
    <style>
      #root {
        height: 100vh;
      }
      #viewer-host,
      #designer-host {
        height: 100%;
      }
      #designer-host {
        display: none;
      }
    </style>
  </head>
  <body onload="load()" style="margin: 0">
    <div id="root">
      <div id="viewer-host"></div>
      <div id="designer-host"></div>
    </div>
    <script>
      var currentReport = undefined;
      var viewerHost = document.getElementById('viewer-host');
      var designerHost = document.getElementById('designer-host');
      function load() {
        var viewer = new ActiveReports.Viewer('#viewer-host', {
          language: 'zh',
        });
        var designer = new GC.ActiveReports.ReportDesigner.Designer(
          '#designer-host',
          { language: 'zh' }
        );
        designer.setActionHandlers({
          onRender(report) {
            currentReport = report.definition;
            viewer.open(currentReport);
            viewerHost.style.display = 'block';
            designerHost.style.display = 'none';
            // return Promise.resolve();
          },
        });
        var designButton = {
          key: '$openDesigner',
          text: '編輯報表',
          iconCssClass: 'mdi mdi-pencil',
          enabled: true,
          action: function (item) {
            designer.setReport({
              definition: currentReport,
            });
            viewerHost.style.display = 'none';
            designerHost.style.display = 'block';
          },
        };
        viewer.toolbar.addItem(designButton);
        viewer.toolbar.updateLayout({
          default: [
            '$openDesigner',
            '$split',
            '$navigation',
            '$split',
            '$refresh',
            '$split',
            '$history',
            '$split',
            '$zoom',
            '$fullscreen',
            '$split',
            '$print',
            '$split',
            '$singlepagemode',
            '$continuousmode',
            '$galleymode',
          ],
        });
        fetch('certificate.rdlx-json')
          .then(function (data) {
            return data.json();
          })
          .then(function (report) {
            currentReport = report;
            viewer.open(report);
          });
      }
    </script>
  </body>
</html>
```

## Go live

![activereportsjs embedded designer and viewer.png](http://192.168.25.60:8000/files/file_storage/a31c1efc.png)

## 設定中文字體 
到專案根目錄

### 新增放置字體檔的資料夾 `Fonts`，並放置中文字體檔
- 新增一個資料夾 `Fonts`，將中文字體檔 `標楷體.ttf` 放入

### 新增字體設定檔 `fontsConfig.json`
- 新增中文字體設定檔，格式如下

```json
{
	"path": "",
	"descriptors": [
		{
			"name": "標楷體",
			"weight": "100",
			"style": "normal",
			"source": "Fonts/標楷體.ttf"
		},		
	]
}
```

![activereportsjs embedded designer add fontsConfig for adding font setting.png](http://192.168.25.60:8000/files/file_storage/b3412cbf.png)

### 在 `html` 的 `<head>` 中設定使用字體檔路徑
```html
	<head>
    <script>
      GC.ActiveReports.Core.FontStore.registerFonts(
        './fontsConfig.json' // replace the URL with the actual one
      );
    </script>
  </head>
```

![activereportsjs embedded designer html add fontsConfig setting.png](http://192.168.25.60:8000/files/file_storage/eb218bad.png)

### 可以在 Designer 中將有設定中文字體的 `certificate.rdlx-json` 匯出顯示中文
- 在 preview 與匯出成 PDF 與 EXCEL 可以顯示出中文







