---
title: Koa Dependencies ( Authentication )
description: 驗證套件
published: true
date: 2023-05-17T03:08:00.251Z
tags: koa, framework
editor: markdown
dateCreated: 2022-07-26T03:27:45.254Z
---

# 驗證套件介紹 ( Authentication Dependencies )
## activedirectory
> ActiveDirectory is an ldapjs client for authN (authentication) and authZ (authorization) for Microsoft Active Directory with range retrieval support for large Active Directory installations.

> [reference](https://www.npmjs.com/package/activedirectory) 
{.is-info}

### Install
```shell
npm i activedirectory --save
```
### Usage


## jsonwebtoken
> - An implementation of JSON Web Tokens.
> - 產生 JWT
> - [JWT Concept](http://192.168.25.60:9005/e/zh-tw/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC/%E5%AD%B8%E7%BF%92%E5%BF%83%E5%BE%97/11542/Basic/WebDev/JWT)

### Install
> [reference](https://www.npmjs.com/package/jsonwebtoken) 
{.is-info}
```shell
npm i jsonwebtoken --save
```
### Usage
> [reference](https://github.com/auth0/node-jsonwebtoken) 
{.is-info}

透過模組上的 sign() 方法可以產生一組 JWT
```javascript
// import
const jwt = require('jsonwebtoken');
// 產生 JWT
jwt.sign(payload, secretOrPrivateKey, [options, callback])
```
- `payload`：存放在 Token 當中的資料
- `secretOrPrivateKey`：密鑰 Secret
- `options`：非必填，但透過帶入 options 物件能設定許多選項
	- `algorithm`：設定產生簽章要使用的雜湊演算法（預設： HS256）
	- `expiresIn`：設定 Token 多久後會過期（自動在 Payload 新增 exp）
	- `noTimestamp`：設定產生 JWT 時不會自動在 Payload 中新增 iat 時間
- `callback`：非必填，但若要以非同步方式產生 JWT，可以提供一個 Callback 函式，Token 將能在 Callback 函式中取得
```javascript
// verificationService.js
// import
const jwt = require('jsonwebtoken');
// 產生 JWT
const payload = { EmployeeID: employeeID };
const secret = process.env.JWT_PASSPORT_SECRET;
const jwtSignOptions = { expiresIn: '1min' };
const token = jwt.sign(payload, secret, jwtSignOptions);
```

```diagram
PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI2MDFweCIgaGVpZ2h0PSIxMjIycHgiIHZpZXdCb3g9Ii0wLjUgLTAuNSA2MDEgMTIyMiIgY29udGVudD0iJmx0O214ZmlsZSBob3N0PSZxdW90O2VtYmVkLmRpYWdyYW1zLm5ldCZxdW90OyBtb2RpZmllZD0mcXVvdDsyMDIyLTA2LTEwVDAyOjI2OjQzLjIyOFomcXVvdDsgYWdlbnQ9JnF1b3Q7NS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMDIuMC4wLjAgU2FmYXJpLzUzNy4zNiZxdW90OyBldGFnPSZxdW90O2VraVBoaUJ2ZkZBNEVoai1TMG5mJnF1b3Q7IHZlcnNpb249JnF1b3Q7MTkuMC4zJnF1b3Q7IHR5cGU9JnF1b3Q7ZW1iZWQmcXVvdDsmZ3Q7Jmx0O2RpYWdyYW0gaWQ9JnF1b3Q7aHdlWjgwYUpDSTRBTDJhYmNLTmUmcXVvdDsgbmFtZT0mcXVvdDtKV1QmcXVvdDsmZ3Q7N1ZwdGM2TTJFUDQxbW1rL0pDUEFZUHdSL0hLZHp2V2FhVEp6dlU4ZEdSU2JpNHdvNERqdXIrK3VFTVlZc1BFbGNlWW1ZZktDVnRLeWtuYWZaeVVnMW5qMTlDbGx5ZklQR1hKQlRCbytFV3RDVE5NWW1DYkJIeHB1QzhuUTBZSkZHb1c2VVNXNGpmN2pXa2kxZEIyRlBLczF6S1VVZVpUVWhZR01ZeDdrTlJsTFU3bXBON3VYb3Y3VWhDMTRRM0FiTU5HVWZvM0NmS21saGpPcUtuN2owV0twSCsyYXc2Sml4Y3JHZWlUWmtvVnlzeWV5cHNRYXAxTG14ZDNxYWN3RlRsNDVMMFcvV1VmdHpyQ1V4M21mRHFhajdjaTM1ZUI0Q0dQVlJabm1TN21RTVJQVFN1cW5jaDJISERWUUtGVnRQa3VaZ05BQTRYZWU1MXU5Y0d5ZFN4QXQ4NVhRdFdCY3V2MGIrMS9iWmZHYlZxY0trNmRhYWF0TGdzMjU4Rm53c0ZBbWpLV1FLVlRGTWthejdtV2NseUppV2pOMWdidzVKM3FhTXJsT0F6MXE3WUE1U3hlOGJLVlhFeWRrcjUrZXlFOWNyamdZQncxU0xsZ2VQZGFkZzJrZlcremFWY3NBTjNvbE9sYWxVUEhJeEZvckphWWpjajNHMm5JNS82NWxXWEdWcVFuM29JRTVTSjdVME10NnVGdm8vMHJSZkNlWURzbG9RRHlYVEIzaXVzUjMxTTJJakN3eXRZazdJWjVSZGdLNzV3MUY2YUVFV2hWbTFzV2RwbmNiMlhlMGh0TXgyaHVab1Ixc0JYN3B4L01zT1cxbWxyRDRXYzhFdlN5SjRPODY0ekEzc3l4YXhGRzg5OVRpQ1NmbTdDQW9xNUREK05rc281emZKa3c1N3dZd3RoNWU5NUVRZTRIQVRFcE5qTE1zVCtVRDM2dHhaaFF1cUdFQ2pBUlpBQ0VDUmpkaTZWNWR4Mkxwa2FjNWZ6b2FKcnAyTU5EWXA4Ry9MRzRxSk4zSmxuc2dhbEQ2L01neW5QTkQ2MmdRUFNjVUlieEdCdkhIS3M1bXhEc2VVNDNJNit1cC9iR2dkRlU2QmcycEZBSWR1TnVBRDE4KzlHVklBWXdMZW5PWlZyeDc5aTZwZXArK3l4VHI4dlJkV25NaC9yYUpiNUNSVGFiQTJjRGNQdDU0Y0Q4a1U1ZDRFK1R5dnZ4OURsRSttNXdUbG1VSitOODF1TmdTVmpjS1dNNC9RQVFjdHpjanZrU3U2Ylk0NitWQjVUVlRlOW9DRHNhYjVmYjBvdUF3SVA2RStMTXF5emZwNzEvdjRHOExTa0FidUFFTXdjWTI4ZXlYekVmdTJTb1MyMklBTzZUUkRiNUljQWVUM3JJNGczOTM0OE42WW81YmV2Mlo4SGpYcTYxREJqVlhrSVJIUmFEU2M0SHA2dnVtV0k4VWdHbXg3VTU3K3NIbSswRXd5N2xrVG0rT1ByS2dHcWpWZ001OE02QXIzZWdWdDFyZDdYdHY0MGRIZG1mK2xJeW1CZkljMi9EMHpvVGNqbWNCenZ5VE1DRlorRktIRTUyalF1QWY0cW1PYjVZakhMWlJnVXQ4aTdpRnhDV3VkM3JQMStOa3FOZCsrY2lLZ0MxRDRydUtuMFpxNHp6QW91ZW9vUlJuVjdDVjF0VFZoY3BOUTEvcldLcHJ2UitSa3pEb0FpYkVITERneExKM2JMN2ZLNzNZNWlYcHhhS051WDJuOU5KeVJtNWFiMFl2M1lma3gxRnlveDBFSTNTdTN2eTA1SWFtMVFsQ1BiQVM4Y2tqN2dCUDBxR05aNm5VMmlTK3A4N1dLY0xZY1R4dFl1ZXp0OXNuWjZjZGNWMVhEMDJQMGNFTkFxQXZJcTZIWjVZdFZTTWNJeEtNaXk4UDNMR2FoeGx1UUxBWFJmbzVkL2huV0oya1ViWmkxM2o4bnAzOW5IY01xNDU3VVZnMUduUDdUbUhWYW9IVndadkJxblhSNDRsRzJ0WjZLdUhiWkVRVnZrQzZPajRySzNvMU9BMWg2WC81OVdlRGpleUI1OEZTTy9VcllJaDcwYmQ1WlpoY3psbXBJcm9lUHRxU0ZPejUrc2hYRzh1UFUvbWZoeDBOMnY5WS9pWG9zUTJIRC9reURqMzhtZ2xuUk1DeVJVRjlndXRzeVoraWZJLzVvUFN0SkVXNHIzZ1BDeVh0L1NoZDlpTytRWlA0eXZmekwwZDh1dXVOakZSZzZOVzFyY1BWSFI0c1dtR3A3bGF0VzBPVGMxSlRNYjZHSnVVQnV4SDFjNHFUZUJmc2dxR0thNHZTSUVDZnJFUTljSkgyeDhVbUhLb3ZpUkFPYlVTKzBVemhJdXdLekdPWWR3cGMwQ2MrWXg2R3JzM0JWRFpYVmJUdTlRMlF3SmdIRkJPZXJsaEZZYWl5eWVOSlhWRXIwNUNuQnpWTjd5NmpWWDl3cUEwajFjdWUwN0R6M0V4T3pyL2pwNDVnbHdEQVhjTEdGcmMvKzhxQ3dSZTIwdnE3M3dFNXlHU3VvWGFzTHI1TjFuM3Z0b251aXgrSHNDam02VzBnRSs3ajFERnRHclR6a2tRZ1owUXlMcHJYM3FaTUxkd2F1c2FEWkZkbFJkRlRGQ3Y3SXh5dXVLeUhvMnBCR0QyMmFvVVZ5cSswOTZCYXdlL3pOclcybmtqVDN2TmNwZlFIVHUxZXhDUzdzR3AvNnNFNGU5SmxuN21QS2ZhZVAycTg2V1IwdEYzdnJZd2VEQit5Ykxucnk5SkFkelhwQWZ2cnVHb1N2N3FhUEY5Y0p5TzRSQUkxYTAwY21NczhsNnVqa1o3QjBLSjRjYWQybDdRUzRKQ29IdUFOeXdGblVDRytYQjJBRkVLVlRjTW8zOUZ3enZJOXJFcDRHa0VUeEtaSmltZ1JMd1MvcVlSK0xEWE1WVnZQR3hhR3hYT0xQRWpJalZkK3lJeVNPdkFVUEo2d3VPUitlTXc2elFCZC91SkYyQlJOd0ViZEErMU1rS0Y0T24wRVdDdjFzbmtteFRybjNtN3hkaTBWdU5qb2ZQUWFRMkZNMVM5NjNWZ0oyMlREcHREQVVxbWhMbXlURGUwMmxVYkxzdzlsWm91d1ZXWExzK21Ca2ZEeklsbW1XMDhlMm5aUHRDWEZkTS9QTUtHb0thSXNWbCtaRjZsSTlhMitOZjBmJmx0Oy9kaWFncmFtJmd0OyZsdDsvbXhmaWxlJmd0OyI+PGRlZnMvPjxnPjxwYXRoIGQ9Ik0gNDgwIDEwMCBMIDQ4MCAxNTMuNjMiIGZpbGw9Im5vbmUiIHN0cm9rZT0icmdiKDAsIDAsIDApIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJzdHJva2UiLz48cGF0aCBkPSJNIDQ4MCAxNTguODggTCA0NzYuNSAxNTEuODggTCA0ODAgMTUzLjYzIEwgNDgzLjUgMTUxLjg4IFoiIGZpbGw9InJnYigwLCAwLCAwKSIgc3Ryb2tlPSJyZ2IoMCwgMCwgMCkiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxyZWN0IHg9IjM2MCIgeT0iMCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxMDAiIHJ4PSIxNSIgcnk9IjE1IiBmaWxsPSIjYTIwMDI1IiBzdHJva2U9IiM2ZjAwMDAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiIHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogMjM4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogNTBweDsgbWFyZ2luLWxlZnQ6IDM2MXB4OyI+PGRpdiBkYXRhLWRyYXdpby1jb2xvcnM9ImNvbG9yOiAjZmZmZmZmOyAiIHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMjU1LCAyNTUsIDI1NSk7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsiPjxmb250IHN0eWxlPSJmb250LXNpemU6IDI0cHg7Ij48Yj7nlKjmiLbmiZPljaE8L2I+PGJyIC8+PC9mb250Pjxmb250IHN0eWxlPSIiPjxmb250IHN0eWxlPSJmb250LXNpemU6IDE2cHg7Ij5Qb3N0wqA8L2ZvbnQ+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogMTZweDsiPi9hcGkvdXNlci9zaWduaW48L3NwYW4+PC9mb250PjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSI0ODAiIHk9IjU0IiBmaWxsPSIjZmZmZmZmIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPueUqOaItuaJk+WNoSYjeGE7UG9zdMKgL2FwaS91c2VyL3NpZ25pbjwvdGV4dD48L3N3aXRjaD48L2c+PHJlY3QgeD0iMzYwIiB5PSIxMTIxIiB3aWR0aD0iMjQwIiBoZWlnaHQ9IjEwMCIgcng9IjE1IiByeT0iMTUiIGZpbGw9IiNhMjAwMjUiIHN0cm9rZT0iIzZmMDAwMCIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjUgLTAuNSkiPjxzd2l0Y2g+PGZvcmVpZ25PYmplY3QgcG9pbnRlci1ldmVudHM9Im5vbmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSIgc3R5bGU9Im92ZXJmbG93OiB2aXNpYmxlOyB0ZXh0LWFsaWduOiBsZWZ0OyI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiB1bnNhZmUgY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IHVuc2FmZSBjZW50ZXI7IHdpZHRoOiAyMzhweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiAxMTcxcHg7IG1hcmdpbi1sZWZ0OiAzNjFweDsiPjxkaXYgZGF0YS1kcmF3aW8tY29sb3JzPSJjb2xvcjogI2ZmZmZmZjsgIiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwcHg7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDI1NSwgMjU1LCAyNTUpOyBsaW5lLWhlaWdodDogMS4yOyBwb2ludGVyLWV2ZW50czogYWxsOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7Ij48Zm9udCBzdHlsZT0iIj48YiBzdHlsZT0iZm9udC1zaXplOiAyNHB4OyI+5ZG85Y+rPGJyIC8+PC9iPjxzcGFuIHN0eWxlPSJmb250LXNpemU6IDI0cHg7Ij48Yj5zaWduaW4gQ29udHJvbGxlcjwvYj48L3NwYW4+PC9mb250PjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSI0ODAiIHk9IjExNzUiIGZpbGw9IiNmZmZmZmYiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiIGZvbnQtc2l6ZT0iMTJweCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5ZG85Y+rJiN4YTtzaWduaW4gQ29udHJvbGxlcjwvdGV4dD48L3N3aXRjaD48L2c+PHBhdGggZD0iTSA0ODAgMjYxIEwgNDgwIDMxMy42MyIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZ2IoMCwgMCwgMCkiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9InN0cm9rZSIvPjxwYXRoIGQ9Ik0gNDgwIDMxOC44OCBMIDQ3Ni41IDMxMS44OCBMIDQ4MCAzMTMuNjMgTCA0ODMuNSAzMTEuODggWiIgZmlsbD0icmdiKDAsIDAsIDApIiBzdHJva2U9InJnYigwLCAwLCAwKSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHJlY3QgeD0iMzYwIiB5PSIxNjAiIHdpZHRoPSIyNDAiIGhlaWdodD0iMTAxIiByeD0iMTUuMTUiIHJ5PSIxNS4xNSIgZmlsbD0iI2EyMDAyNSIgc3Ryb2tlPSIjNmYwMDAwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5IiBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDIzOHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDIxMXB4OyBtYXJnaW4tbGVmdDogMzYxcHg7Ij48ZGl2IGRhdGEtZHJhd2lvLWNvbG9ycz0iY29sb3I6ICNmZmZmZmY7ICIgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyI+PGZvbnQgc3R5bGU9ImZvbnQtc2l6ZTogMjRweDsiPjxiPuWxlemWi+mpl+itiTwvYj48YnIgLz7CoDwvZm9udD48Zm9udCBzdHlsZT0iZm9udC1zaXplOiAxNnB4OyI+cGFzc3BvcnQuYXV0aGVudGljYXRlPC9mb250PjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSI0ODAiIHk9IjIxNCIgZmlsbD0iI2ZmZmZmZiIgZm9udC1mYW1pbHk9IkhlbHZldGljYSIgZm9udC1zaXplPSIxMnB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7lsZXplovpqZforYkmI3hhO8KgcGFzc3BvcnQuYXV0aGVudGljYXRlPC90ZXh0Pjwvc3dpdGNoPjwvZz48cGF0aCBkPSJNIDQ4MCA0MjAgTCA0ODAgNDczLjYzIiBmaWxsPSJub25lIiBzdHJva2U9InJnYigwLCAwLCAwKSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSA0ODAgNDc4Ljg4IEwgNDc2LjUgNDcxLjg4IEwgNDgwIDQ3My42MyBMIDQ4My41IDQ3MS44OCBaIiBmaWxsPSJyZ2IoMCwgMCwgMCkiIHN0cm9rZT0icmdiKDAsIDAsIDApIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cmVjdCB4PSIzNjAiIHk9IjMyMCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxMDAiIHJ4PSIxNSIgcnk9IjE1IiBmaWxsPSIjYTIwMDI1IiBzdHJva2U9IiM2ZjAwMDAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiIHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogMjM4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogMzcwcHg7IG1hcmdpbi1sZWZ0OiAzNjFweDsiPjxkaXYgZGF0YS1kcmF3aW8tY29sb3JzPSJjb2xvcjogI2ZmZmZmZjsgIiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwcHg7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDI1NSwgMjU1LCAyNTUpOyBsaW5lLWhlaWdodDogMS4yOyBwb2ludGVyLWV2ZW50czogYWxsOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7Ij48Zm9udCBzdHlsZT0iZm9udC1zaXplOiAyNHB4OyI+PGI+5L2/55SoIEpXVCDpqZforYnnrZbnlaU8YnIgLz48L2I+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OiAmcXVvdDtOb3RvIFNhbnMgVEMmcXVvdDssICZxdW90O09wZW4gU2FucyZxdW90Oywgc2Fucy1zZXJpZjsgZm9udC1zaXplOiAxNnB4OyI+cGFzc3BvcnQtand0IHN0cmF0ZWd5PC9zcGFuPsKgPC9mb250PjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSI0ODAiIHk9IjM3NCIgZmlsbD0iI2ZmZmZmZiIgZm9udC1mYW1pbHk9IkhlbHZldGljYSIgZm9udC1zaXplPSIxMnB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7kvb/nlKggSldUIOmpl+itieetlueVpS4uLjwvdGV4dD48L3N3aXRjaD48L2c+PHBhdGggZD0iTSA0ODAgNTgwIEwgNDgwIDYzMy42MyIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZ2IoMCwgMCwgMCkiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9InN0cm9rZSIvPjxwYXRoIGQ9Ik0gNDgwIDYzOC44OCBMIDQ3Ni41IDYzMS44OCBMIDQ4MCA2MzMuNjMgTCA0ODMuNSA2MzEuODggWiIgZmlsbD0icmdiKDAsIDAsIDApIiBzdHJva2U9InJnYigwLCAwLCAwKSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHJlY3QgeD0iMzYwIiB5PSI0ODAiIHdpZHRoPSIyNDAiIGhlaWdodD0iMTAwIiByeD0iMTUiIHJ5PSIxNSIgZmlsbD0iI2EyMDAyNSIgc3Ryb2tlPSIjNmYwMDAwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5IiBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDIzOHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDUzMHB4OyBtYXJnaW4tbGVmdDogMzYxcHg7Ij48ZGl2IGRhdGEtZHJhd2lvLWNvbG9ycz0iY29sb3I6ICNmZmZmZmY7ICIgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyI+PGZvbnQgc3R5bGU9IiI+PGIgc3R5bGU9IiI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogMTlweDsiPuW+niA8L3NwYW4+PGZvbnQgc3R5bGU9ImZvbnQtc2l6ZTogMThweDsiPmp3dF9wYWxvYWQ8L2ZvbnQ+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogMTlweDsiPiDnjbLlvpfpqZforYnos4foqIo8L3NwYW4+PC9iPjxiciAvPjxiIHN0eWxlPSJmb250LXNpemU6IDE5cHg7Ij7op7jnmbzkuKbluLblhaXCoDwvYj48YiBzdHlsZT0iIj48Zm9udCBzdHlsZT0iZm9udC1zaXplOiAxOHB4OyI+dmVyaWZ5IGNhbGxiYWNrPC9mb250PjwvYj48L2ZvbnQ+PC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjQ4MCIgeT0iNTM0IiBmaWxsPSIjZmZmZmZmIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPuW+niBqd3RfcGFsb2FkIOeNsuW+l+mpl+itieizh+ioii4uLjwvdGV4dD48L3N3aXRjaD48L2c+PHBhdGggZD0iTSA0ODAgNzQwIEwgNDgwIDc5My42MyIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZ2IoMCwgMCwgMCkiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9InN0cm9rZSIvPjxwYXRoIGQ9Ik0gNDgwIDc5OC44OCBMIDQ3Ni41IDc5MS44OCBMIDQ4MCA3OTMuNjMgTCA0ODMuNSA3OTEuODggWiIgZmlsbD0icmdiKDAsIDAsIDApIiBzdHJva2U9InJnYigwLCAwLCAwKSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHJlY3QgeD0iMzYwIiB5PSI2NDAiIHdpZHRoPSIyNDAiIGhlaWdodD0iMTAwIiByeD0iMTUiIHJ5PSIxNSIgZmlsbD0iI2EyMDAyNSIgc3Ryb2tlPSIjNmYwMDAwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5IiBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDIzOHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDY5MHB4OyBtYXJnaW4tbGVmdDogMzYxcHg7Ij48ZGl2IGRhdGEtZHJhd2lvLWNvbG9ycz0iY29sb3I6ICNmZmZmZmY7ICIgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyI+PHNwYW4gc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkOyBmb250LXNpemU6IDIzcHg7Ij7pqZforYnos4foqIrnmoTmraPnorrmgKc8L3NwYW4+PGJyIC8+PGZvbnQgc3R5bGU9ImZvbnQtc2l6ZTogMTZweDsiPjxzcGFuIHN0eWxlPSIiPuiIh+izh+aWmeW6q+izh+aWmemAsuihjOavlOWwjTwvc3Bhbj48YnIgLz48c3BhbiBzdHlsZT0iIj5wcmlzbWEudXNlcnM8L3NwYW4+PGJyIC8+PC9mb250PjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSI0ODAiIHk9IjY5NCIgZmlsbD0iI2ZmZmZmZiIgZm9udC1mYW1pbHk9IkhlbHZldGljYSIgZm9udC1zaXplPSIxMnB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7pqZforYnos4foqIrnmoTmraPnorrmgKfoiIfos4fmlpnluqvos4fmlpnpgLLooYzmr5TlsI1wcmlzbWEudXNlcnMuLi48L3RleHQ+PC9zd2l0Y2g+PC9nPjxwYXRoIGQ9Ik0gNDgwIDkwMCBMIDQ4MCA5NTMuNjMiIGZpbGw9Im5vbmUiIHN0cm9rZT0icmdiKDAsIDAsIDApIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJzdHJva2UiLz48cGF0aCBkPSJNIDQ4MCA5NTguODggTCA0NzYuNSA5NTEuODggTCA0ODAgOTUzLjYzIEwgNDgzLjUgOTUxLjg4IFoiIGZpbGw9InJnYigwLCAwLCAwKSIgc3Ryb2tlPSJyZ2IoMCwgMCwgMCkiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxyZWN0IHg9IjM2MCIgeT0iODAwIiB3aWR0aD0iMjQwIiBoZWlnaHQ9IjEwMCIgcng9IjE1IiByeT0iMTUiIGZpbGw9IiNhMjAwMjUiIHN0cm9rZT0iIzZmMDAwMCIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjUgLTAuNSkiPjxzd2l0Y2g+PGZvcmVpZ25PYmplY3QgcG9pbnRlci1ldmVudHM9Im5vbmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSIgc3R5bGU9Im92ZXJmbG93OiB2aXNpYmxlOyB0ZXh0LWFsaWduOiBsZWZ0OyI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiB1bnNhZmUgY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IHVuc2FmZSBjZW50ZXI7IHdpZHRoOiAyMzhweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiA4NTBweDsgbWFyZ2luLWxlZnQ6IDM2MXB4OyI+PGRpdiBkYXRhLWRyYXdpby1jb2xvcnM9ImNvbG9yOiAjZmZmZmZmOyAiIHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMjU1LCAyNTUsIDI1NSk7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsiPjxmb250IHN0eWxlPSJmb250LXNpemU6IDI0cHg7Ij48Yj7luLblhaXpqZforYnntZDmnpw8L2I+PC9mb250PjxiciAvPjxmb250IHN0eWxlPSJmb250LXNpemU6IDE2cHg7Ij5kb25lKCk8L2ZvbnQ+PC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjQ4MCIgeT0iODU0IiBmaWxsPSIjZmZmZmZmIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPuW4tuWFpempl+itiee1kOaenCYjeGE7ZG9uZSgpPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIzNjAiIHk9Ijk2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxMDAiIHJ4PSIxNSIgcnk9IjE1IiBmaWxsPSIjYTIwMDI1IiBzdHJva2U9IiM2ZjAwMDAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiIHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogMjM4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogMTAxMHB4OyBtYXJnaW4tbGVmdDogMzYxcHg7Ij48ZGl2IGRhdGEtZHJhd2lvLWNvbG9ycz0iY29sb3I6ICNmZmZmZmY7ICIgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyI+PGZvbnQgc3R5bGU9ImZvbnQtc2l6ZTogMjRweDsiPjxiPuWwh+mpl+itiee1kOaenOizh+ioiuW4tuWbnjwvYj48YnIgLz7CoDwvZm9udD48Zm9udCBzdHlsZT0iZm9udC1zaXplOiAxNnB4OyI+cGFzc3BvcnQuYXV0aGVudGljYXRlPC9mb250PjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSI0ODAiIHk9IjEwMTQiIGZpbGw9IiNmZmZmZmYiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiIGZvbnQtc2l6ZT0iMTJweCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5bCH6amX6K2J57WQ5p6c6LOH6KiK5bi25ZueJiN4YTvCoHBhc3Nwb3J0LmF1dGhlbnRpY2F0ZTwvdGV4dD48L3N3aXRjaD48L2c+PHBhdGggZD0iTSA0ODAgMTA2MCBMIDQ4MCAxMTE0LjYzIiBmaWxsPSJub25lIiBzdHJva2U9InJnYigwLCAwLCAwKSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSA0ODAgMTExOS44OCBMIDQ3Ni41IDExMTIuODggTCA0ODAgMTExNC42MyBMIDQ4My41IDExMTIuODggWiIgZmlsbD0icmdiKDAsIDAsIDApIiBzdHJva2U9InJnYigwLCAwLCAwKSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5IiBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDFweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiAxMDkycHg7IG1hcmdpbi1sZWZ0OiA0ODFweDsiPjxkaXYgZGF0YS1kcmF3aW8tY29sb3JzPSJjb2xvcjogcmdiKDAsIDAsIDApOyAiIHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDExcHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3dyYXA7Ij48Zm9udCBzdHlsZT0iZm9udC1zaXplOiAyMHB4OyIgY29sb3I9IiMwMGNjMDAiPjxiPumpl+itieaIkOWKn+aZgjwvYj48L2ZvbnQ+PC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjQ4MSIgeT0iMTA5NSIgZmlsbD0icmdiKDAsIDAsIDApIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjExcHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPumpl+itieaIkOWKn+aZgjwvdGV4dD48L3N3aXRjaD48L2c+PHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjIwMCIgaGVpZ2h0PSI4MCIgcng9IjEwIiByeT0iMTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzY2NjY2NiIgc3Ryb2tlLWRhc2hhcnJheT0iOCA0IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjUgLTAuNSkiPjxzd2l0Y2g+PGZvcmVpZ25PYmplY3QgcG9pbnRlci1ldmVudHM9Im5vbmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSIgc3R5bGU9Im92ZXJmbG93OiB2aXNpYmxlOyB0ZXh0LWFsaWduOiBsZWZ0OyI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiB1bnNhZmUgZmxleC1lbmQ7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGZsZXgtc3RhcnQ7IHdpZHRoOiAxODJweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiA2OXB4OyBtYXJnaW4tbGVmdDogMTBweDsiPjxkaXYgZGF0YS1kcmF3aW8tY29sb3JzPSJjb2xvcjogIzMzMzMzMzsgIiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwcHg7IHRleHQtYWxpZ246IGxlZnQ7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTFweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYig1MSwgNTEsIDUxKTsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IG5vbmU7IHdoaXRlLXNwYWNlOiBub3JtYWw7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsiPjxmb250IHN0eWxlPSJmb250LXNpemU6IDE2cHgiPjxiPjxkaXYgc3R5bGU9InRleHQtYWxpZ246IGxlZnQiPkpXVCDpqZforYnmtYHnqIs8L2Rpdj48L2I+PC9mb250PjxkaXYgc3R5bGU9InRleHQtYWxpZ246IGxlZnQiPltwYXNzcG9ydC1qd3TjgIFrb2EtcGFzc3BvcnRdPC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjEwIiB5PSI2OSIgZmlsbD0iIzMzMzMzMyIgZm9udC1mYW1pbHk9IkhlbHZldGljYSIgZm9udC1zaXplPSIxMXB4Ij5KV1Qg6amX6K2J5rWB56iLLi4uPC90ZXh0Pjwvc3dpdGNoPjwvZz48L2c+PHN3aXRjaD48ZyByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiLz48YSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLC01KSIgeGxpbms6aHJlZj0iaHR0cHM6Ly93d3cuZGlhZ3JhbXMubmV0L2RvYy9mYXEvc3ZnLWV4cG9ydC10ZXh0LXByb2JsZW1zIiB0YXJnZXQ9Il9ibGFuayI+PHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMHB4IiB4PSI1MCUiIHk9IjEwMCUiPlRleHQgaXMgbm90IFNWRyAtIGNhbm5vdCBkaXNwbGF5PC90ZXh0PjwvYT48L3N3aXRjaD48L3N2Zz4=
```


## passport-jwt
> - A Passport strategy for authenticating with a JSON Web Token
> - This module lets you authenticate endpoints using a JSON web token. It is intended to be used to secure RESTful endpoints without sessions
>  - JWT 驗證

### Install
> [reference](https://www.npmjs.com/package/passport-jwt) 
{.is-info}
```shell
npm i passport-jwt --save
```
### Usage
> [reference](http://www.passportjs.org/packages/passport-jwt/) 
{.is-info}

An example configuration which reads the JWT from the http Authorization header with the scheme 'bearer'.

This code ensures Passport calls the strategy on every authentication request.

The code will execute every time your application calls passport.authenticate('jwt') and as long as the JWT has been signed with the same secret that is held on the server then it will pass when checked. If the JWT is not signed with the same secret held on the server then passport will return 'Unauthorized'.

```javascript
// middleware/passport.js
/**
 * @description passport 的中間件( 解析 token )
 */

const jwtStrategy = require('passport-jwt').Strategy;
const extractJwt = require('passport-jwt').ExtractJwt;
const passport = require('koa-passport');
const prismaClientService = require('../service/prismaClientService');
const opts = {
  jwtFromRequest: extractJwt.fromAuthHeaderAsBearerToken('bearer'),
  secretOrKey: process.env.JWT_PASSPORT_SECRET,
};

// 策略類型
const strategy = new jwtStrategy(opts, async function (jwt_paload, done) {
  try {
    const employeeID = jwt_paload.EmployeeID;
    const whereOpt = {
      EmployeeID: employeeID,
      Active: 1,
    };
    const userInfo = await prismaClientService.prisma.users.findMany({
      select: {
        EmployeeID: true,
      },
      where: whereOpt,
    });
    // 驗證失敗
    if (userInfo.length === 0) {
      return done(null, false);
    }
    // 驗證成功
    return done(null, jwt_paload);
  } catch (error) {
    return done(error, false);
  }
});

// 註冊驗證策略 'jwt'
// passport.use('驗證策略名稱', '想建立的策略類型')
// 註冊驗證策略時，第一個參數可指定註冊驗證策略名稱，passport-jwt 未指定時為 'jwt'
passport.use('jwt', strategy);

module.exports = passport;

```
The JWT authentication strategy is constructed as follows:
```javascript
new JwtStrategy(options, verify)
```
- `options` is an object literal containing options to control how the token is extracted from the request or verified.
 	- `secretOrKey`：必填欄位
  - `jwtFromRequest`：用來代入驗證的函式，找出 JWT（Extractor）的方式
  	- **fromAuthHeaderAsBearerToken()**：從 authorization header 取得 bearer token
  	- fromHeader(header_name)：從指定的 http header name 中找 JWT
    - fromBodyField(field_name)：從 body 的欄位中找 JWT
    - fromUrlQueryParameter(param_name)：從 URL 的 query parameter 中找 JWT
    - fromAuthHeaderWithScheme(auth_scheme)：從 authorization header 中找 JWT
    - fromAuthHeader()：以 scheme 'JWT' 尋找 authorization header（HTTP Header 的寫法要是{Authorization: JWT xxx.yyy.zzz}）
    - fromExtractors([array of extractor functions])：可以用陣列的方式列出所有上述想要使用的方法
- `verify` is a callback function with the parameters **verify(jwt_payload, done)**
	- `jwt_payload` 解碼後的 JWT payload：is an object literal containing the decoded JWT payload.
	- `done` 執行驗證後的結果：is a passport error first callback accepting arguments **done(error, user, info)**
  	- 在 Passport 驗證一個 request 時，它會解析 request 中的登入資訊（credentials），接著以這些 credentials 當作參數來執行 verify callback
		- `error` 錯誤訊息：例如在伺服器端回傳錯誤訊息時，帶入錯誤訊息 err；無錯誤訊息時，則可以帶入 null 取代<error|null>
		- `user` 使用者資料：驗證成功時，帶入使用者資料 user；驗證失敗時，則可以帶入 false 取代
		- `info` 驗證失敗訊息：當驗證失敗時，可以額外補充驗證失敗的原因和資訊
```javascript
// done(<error|null>, <user|false>, {message: 'incorrect reason'})

// credentials 是有效的
// 驗證成功時，提供 Passport 該名使用者資料
return done(null, user)

// credentials 是無效的
// 驗證失敗時，不提供 Passport 任何使用者資料
return done(null, false)

// 驗證失敗時，不提供 Passport 任何使用者資料，但告知失敗原因
return done(null, false, { message: 'Incorrect password.' })

// 當伺服器端產生錯誤訊息時，提供 Passport 錯誤訊息內容，這時候 err 會被設為非 null 的值；如果是驗證失敗（伺服器沒有錯誤）應該則此值要設定成 null
return done(err)
```

## koa-passport
> - Passport middleware for Koa
> - Passport 將身分驗證獨立為「驗證策略」 Strategy，寫好的驗證策略會經由 passport.use 掛鉤於一全域物件，接著由 middleware passport.authenticate 指派使用的驗證策略，因此有關於身份驗證只需經過各自寫好的 passport 模組即可

### Install
> [reference](https://www.npmjs.com/package/koa-passport) 
{.is-info}
```shell
npm i koa-passport --save
```
### Usage
> [reference](https://medium.com/@rob.s.ellis/koa-api-secured-with-passport-jwt-2fd2d32771bdt) 
{.is-info}
- 在 app.js 中 import 建立好的 middleware passport ，並初始化
```javascript
// app.js
// import middleware passport
const passport = require('./middleware/passport');
// 初始化 passport
app.use(passport.initialize());
```

- Use **passport.authenticate(strategy, options)** specifying 'jwt' as the strategy
	- `strategy`：使用策略，例如 : 'jwt'
  - `options`：其他參數，{ session: false } 可以設定驗證後是否要存入 session 中
- Securing Routes Individually
- 對單一 router 進行 JWT 驗證
- 設定好的 Passport Strategy 可以直接在 routes 中使用
- 如果認證失敗，Passport 會回傳 401 Unauthorized 的狀態，後續的路由都不會再被處理；如果認證成功，則會觸發 next
```javascript
// routes/api/signin.js
// import
const passport = require('koa-passport');
// 在呼叫 Controller 之前進行 JWT 驗證
/**
 * @description 用戶打卡接口地址( POST api/user/signin )
 */
router.post(
  '/signin',
  // passport as middleware
  // 呼叫策略 'jwt' : JWT 驗證
  passport.authenticate('jwt', { session: false }),
  // 資料校驗
  getValidator(signinValidate),
  // routes handler
  async (ctx, next) => {
    ctx.body = await signinController.signin(ctx, next);
  },
);
```






